<!DOCTYPE html>
<html lang="tr">
<head>
  <meta charset="UTF-8">
  <title>3 QR Yan Yana</title>
  <script src="https://cdn.jsdelivr.net/npm/qrcode/build/qrcode.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <style>
    body { font-family: Arial, sans-serif; text-align: center; margin-top: 20px; }
    #preview { margin-top: 20px; }
    canvas { margin: 0; }
    button { margin: 5px; padding: 8px 12px; }
  </style>
</head>
<body>
  <h2>3 Adet Yan Yana QR Kodu</h2>
  <label>Adres: <input id="qrText" type="text" size="50" value="https://bektastekstil.com.tr/tr/"></label>
  <br><br>
  <button onclick="generateQR()">QR Oluştur</button>
  <button onclick="downloadPNG()">PNG indir</button>
  <button onclick="downloadPDF()">PDF indir</button>

  <div id="preview">
    <canvas id="finalCanvas"></canvas>
  </div>

<script>
const mm2px = mm => Math.round(mm * 3.78); // 96dpi için
const qrSize = mm2px(30);   // 30mm -> 113px
const padding = mm2px(2);   // 2mm -> 8px
const gap = mm2px(3);       // 3mm -> 11px
const totalWidth = mm2px(100); // 100mm -> 378px
const totalHeight = mm2px(34); // 34mm -> 128px

async function generateQR() {
  const text = document.getElementById("qrText").value;
  const qrCanvasList = [];

  for (let i = 0; i < 3; i++) {
    const c = document.createElement("canvas");
    c.width = qrSize;
    c.height = qrSize;
    await QRCode.toCanvas(c, text, { width: qrSize, margin: 0 });
    qrCanvasList.push(c);
  }

  const finalCanvas = document.getElementById("finalCanvas");
  finalCanvas.width = totalWidth;
  finalCanvas.height = totalHeight;
  const ctx = finalCanvas.getContext("2d");
  ctx.fillStyle = "white";
  ctx.fillRect(0, 0, totalWidth, totalHeight);

  let x = padding;
  const y = padding;
  qrCanvasList.forEach((qr, idx) => {
    ctx.drawImage(qr, x, y, qrSize, qrSize);
    x += qrSize + gap;
  });
}

function downloadPNG() {
  const canvas = document.getElementById("finalCanvas");
  const link = document.createElement("a");
  link.download = "qrcodes.png";
  link.href = canvas.toDataURL("image/png");
  link.click();
}

function downloadPDF() {
  const { jsPDF } = window.jspdf;
  const pdf = new jsPDF({
    orientation: "landscape",
    unit: "mm",
    format: [100, 34] // genişlik x yükseklik mm
  });

  const canvas = document.getElementById("finalCanvas");
  const imgData = canvas.toDataURL("image/png");

  pdf.addImage(imgData, "PNG", 0, 0, 100, 34);
  pdf.save("qrcodes.pdf");
}
</script>
</body>
</html>
